"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _express=require("express");var _path=_interopRequireDefault(require("path"));var _expressAsyncHandler=_interopRequireDefault(require("express-async-handler"));var _FileAsync=_interopRequireDefault(require("lowdb/adapters/FileAsync"));var _lowdb=_interopRequireDefault(require("lowdb"));var adapter=new _FileAsync["default"](_path["default"].resolve(__dirname,"../../Data.json"));var Route=(0,_express.Router)().get("/list",(0,_expressAsyncHandler["default"])(function(){var _ref=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(req,res){var db,limit,list;return _regenerator["default"].wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return(0,_lowdb["default"])(adapter);case 2:db=_context.sent;limit=req.query.limit;list=limit?db.get("list").take(limit).value():db.get("list").value();res.json(list);case 6:case"end":return _context.stop();}}},_callee)}));return function(_x,_x2){return _ref.apply(this,arguments)}}())).get("/manga/:id",(0,_expressAsyncHandler["default"])(function(){var _ref2=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee2(req,res){var db,manga;return _regenerator["default"].wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_lowdb["default"])(adapter);case 2:db=_context2.sent;manga=db.get("manga").find({id:req.params.id}).value();if(!manga){_context2.next=6;break}return _context2.abrupt("return",res.json(manga));case 6:throw{status:404,message:"Manga not found"};case 7:case"end":return _context2.stop();}}},_callee2)}));return function(_x3,_x4){return _ref2.apply(this,arguments)}}()));var _default=Route;exports["default"]=_default;